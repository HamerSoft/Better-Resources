<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Better Resources: Better Resources</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Logo.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Better Resources
   </div>
   <div id="projectbrief">A better way to interact with Unity3D resources</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Better Resources </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a> Better Resources is a library that offers a better API to interact with Unity3D resources. Most notably, it extends the existing <a href="https://docs.unity3d.com/ScriptReference/Resources.html">Resources</a> with the capability to query all resource paths in your project and imported packages, both at <b>design-and-run-time</b>!</p>
<p><img src="https://github.com/HamerSoft/better-resources/.github/workflows/main.yml/badge.svg" alt="WorkflowBadge" style="pointer-events: none;" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md5"></a>
Getting Started</h1>
<p>Better Resources exposes the complete UnityEngine <a href="https://docs.unity3d.com/ScriptReference/Resources.html">Resources</a> API, which can be used straight out of the box. However, in order to query all resources in a project (including packages) a ResourcesCache is needed.</p>
<p>A ResourcesCache can be generated through the different overloads of <a href="Editor/BetterResourcesEditor.cs">BetterResourcesEditor</a>. This file can be generated <b>in the Unity3D editor</b> from the <code>Tools/HamerSoft/BetterResources/Generate Cache</code> menu in the toolbar or through the available API. BetterResources also comes with a pre-made pre-build hook to generate a ResourcesCache before a build is compiled. See <a href="#Enabling-the-built-in-pre-build-hook">enabling the built-in pre-build hook</a> for more information.</p>
<p>Once a cache is generated and saved in a Resources root folder like: <code>&lt;Project&gt;/Assets/Resources/ResourcesCache</code> it can be used in a build to initialize BetterResources to enable queries.</p>
<h2><a class="anchor" id="autotoc_md6"></a>
Documentation</h2>
<p>For more detailed docs please review the <a href="https://hamersoft.github.io/better-resources/">GH-Pages</a>.</p>
<h1><a class="anchor" id="autotoc_md7"></a>
Initialization</h1>
<p>BetterResources requires an initialization step (on the main thread) in order to enable querying the available resources at run-time. This step is needed to load a ResourcesCache, which was made in the editor, into memory.</p>
<p>BetterResources exposes 3 flavors of initialization for a fitting coding style:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Initialization   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">BetterResources.Initialize   </td><td class="markdownTableBodyNone">Blocking initialization on the main thread.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">BetterResources.InitializeAsync   </td><td class="markdownTableBodyNone">Non-blocking initialization using async/await.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">BetterResources.InitializeRoutine   </td><td class="markdownTableBodyNone">Non-blocking initialization using a Unity3D coroutine.   </td></tr>
</table>
<p>Once the initialization process has finished the ResourcesCache is loaded into memory and queries are enabled. <em>Note: BetterResources exposes a (static) <code>Initialized</code> event with a boolean flag to check if the initialization was successful.</em></p>
<h1><a class="anchor" id="autotoc_md8"></a>
Queries</h1>
<p>The core piece of functionality BetterResources exposes over the default <a href="https://docs.unity3d.com/ScriptReference/Resources.html">Resources</a> API Unity3D provides is: <b>Being able to query available resources at design-and-run-time</b>. BetterResources exposes a nice <a href="Runtime/QueryBuilder.cs">QueryBuilder</a> object to create fine-grained lookups for resources.</p>
<p>For example: <em>Let's say we want to find all resources in your custom made package in some root <code>Resources</code> folder with a <a href="https://docs.unity3d.com/Manual/class-Camera.html">Camera</a> component, but without an <a href="https://docs.unity3d.com/ScriptReference/AudioListener.html">AudioListener</a> component (because the rule of two doesn't work well here :D).</em></p>
<div class="fragment"><div class="line">using var query = BetterResources.Query()</div>
<div class="line">          .ByPackage(&quot;com.my-org.package&quot;)</div>
<div class="line">          .AtRoot()</div>
<div class="line">          .WithSomeComponents(typeof(Camera))</div>
<div class="line">          .WithoutAllComponents(typeof(AudioListener));</div>
<div class="line">          </div>
<div class="line">var results = query.GetResults();</div>
<div class="line">// do something with results</div>
</div><!-- fragment --><p> <em>*The QueryBuilder supports a lot more filters so be sure to check them out, and if you have a suggestion for a useful filter that is missing please create a ticket, or better yet, create a pull-request.</em></p>
<p><em>The QueryBuilder implements an IDisposable interface so it's best to use it in a <a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/statements/using">using</a> statement for resource optimization.</em></p>
<h1><a class="anchor" id="autotoc_md9"></a>
Misc</h1>
<h2><a class="anchor" id="autotoc_md10"></a>
Root &amp; Nested Resources folders</h2>
<p>In contrary to common believe, Unity3D does support nested resources folders. So, for example: A path like: <code>&lt;Project&gt;/Assets/Resources/RandomFolder/Resources/MyAsset.asset</code> is supported by Unity3D. Another fun fact is that <code>MyAsset.asset</code> can be loaded through the built-in Resources Api using these two paths:</p>
<div class="fragment"><div class="line">// Like this</div>
<div class="line">Resources.Load(&quot;MyAsset&quot;);</div>
<div class="line">// or</div>
<div class="line">Resources.Load(&quot;RandomFolder/Resources/MyAsset&quot;);</div>
</div><!-- fragment --><p>This is because each occurence of a directory called <code>Resources</code> is treated as a root to load from.</p>
<h2><a class="anchor" id="autotoc_md11"></a>
Non-Root Resources</h2>
<p>The Resources folder also doesn't have to be in the root of the Unity3D project or package. It's perfectly viable to have a <code>Resources</code> folder located at <code>&lt;Project&gt;/Assets/SomeFolder/AnotherFolder/Resources</code>. This Resources folder, will be treated as a root folder like no other.</p>
<h2><a class="anchor" id="autotoc_md12"></a>
Enabling the built-in pre-build hook</h2>
<p>Better Resources has a built-in pre-build hook that can be enabled to generate a ResourceCache just before a build is made. The hook is executed when a build is triggered through the Unity3D <a href="https://docs.unity3d.com/Manual/BuildSettings.html">BuildSettings</a> The pre-build hook can be enabled in different ways:</p>
<h3><a class="anchor" id="autotoc_md13"></a>
Custom Define in Code</h3>
<p>Add the custom <code>BETTERRESOURCES_PRE_BUILD</code> define at the top of some file.</p>
<div class="fragment"><div class="line">#define BETTERRESOURCES_PRE_BUILD</div>
<div class="line"> </div>
<div class="line">public class MyRandomClass</div>
<div class="line">{</div>
<div class="line">    </div>
<div class="line">}</div>
</div><!-- fragment --><p>You could also wrap this define in line a <code>UNITY_ANDROID</code> define if you just want to use the hook before making an Android build for example.</p>
<h3><a class="anchor" id="autotoc_md14"></a>
Custom Define in PlayerSettings</h3>
<p>Add the custom <code>BETTERRESOURCES_PRE_BUILD</code> define to the <a href="https://docs.unity3d.com/Manual/class-PlayerSettings.html">PlayerSettings</a> in the <code>other</code> tab (per platform) like so:</p>
<p><img src="Docs~/PreBuildDefine.png" alt="PreBuildDefine" class="inline"/></p>
<h3><a class="anchor" id="autotoc_md15"></a>
Custom Define through Unity3D API</h3>
<p>A custom define can also be set through the Unity3D <a href="https://docs.unity3d.com/ScriptReference/PlayerSettings.SetScriptingDefineSymbols.html">PlayerDefineSymbols</a> API. Just remember to do it for all platforms needed, just like the other alternatives.</p>
<h3><a class="anchor" id="autotoc_md16"></a>
Custom implementation</h3>
<p>A totally custom implementation is always possible. Inspiration can be taken from <a href="Editor/PreBuildHook.cs">PreBuildHook</a>. The <a href="Editor/BetterResourcesEditor.cs">BetterResourcesEditor</a> exposes a number of overloads to generate a cache. These could be called through a custom pre-build hook, CloudBuild <a href="https://docs.unity3d.com/2019.4/Documentation/Manual/UnityCloudBuildPreAndPostExportMethods.html">Pre-Export</a> method or a custom CI implementation like GitHub Actions. _Just remember that most, if not all, of the pre-and-post build handlers in Unity run <u>synchronously!</u>_</p>
<h1><a class="anchor" id="autotoc_md17"></a>
Editor Integration</h1>
<p>Better Resources also comes with a AssetPostProcessor. This PostProcessor will detect if there's any changes being made to files in <code>Resources</code> directories. Once a new asset is added, deleted or moved to the <code>Resources</code> folder(s) it will kick in and generate a new cache and initialize BetterResources for use. It's main use is for better integration with custom Editor plugins that might use BetterResources to find resources. By using the AssetPostProcessor a new cache is generated and initialization is done automatically.</p>
<p>The AssetPostProcessor can be enabled by adding the scripting define: <code>BETTERRESOURCES_AUTO_GENERATE</code>. <em>*The process for adding this custom define is identical to adding it for the pre-build hook.</em></p>
<h1><a class="anchor" id="autotoc_md18"></a>
Custom Define Summary</h1>
<p>A summary of the custom defines for Better Resources is the following:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Define   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">BETTERRESOURCES_PRE_BUILD   </td><td class="markdownTableBodyNone">Enables the pre-made pre-build hook to generate the cache once a build is made.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">BETTERRESOURCES_AUTO_GENERATE   </td><td class="markdownTableBodyNone">Enables Editor integration, this is useful for writing Editor Plugins that need access to BetterResources.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">BETTERRESOURCES_LOG   </td><td class="markdownTableBodyNone">Enables logging. (Logging is a bit incomplete)   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md19"></a>
Acknowledgements</h1>
<p>Better Resources is a tribute to another amazing library called <a href="https://github.com/gwiazdorrr/BetterStreamingAssets">BetterStreamingAssets</a>, hence the name :)</p>
<p><code>"Better Streaming Assets is a plugin that lets you access Streaming Assets directly in an uniform and thread-safe way, with tiny overhead. Mostly beneficial for Android projects, where the alternatives are to use archaic and hugely inefficient WWW or embed data in Asset Bundles. API is based on Syste.IO.File and System.IO.Directory classes."</code> </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
